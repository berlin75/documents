<style>
#test{height: 100px;width: 100px;position: relative;background-color: lightblue;}
#test:before{content:'我是伪元素';position: absolute;height: 100px;width: 100px;background-color: pink;left:200px;}
#test:hover:before{width: 200px;transition: width 1.5s 0.5s;}

</style>

<body>
<div id="test"></div>

<script>
let dataSource = {
  "material_id": 70,
  "trade_name": "Apple iPhone 11 (A2223) 128GB 黑色 移动联通电信4G手机 双卡双待",
  "main_img": 'DEFAULT_PNG',
  "sku_list": [
    {
      "sku_id": 101,
      "material_id": 70,
      "sku_price": 179,
      "main_img": 'SKU_1_PNG',
      "sku_prop": [
        {
          "attribute_id": 58,
          "attribute_name": "颜色",
          "attribute_value_id": 143,
          "attribute_value": "白色"
        },
        {
          "attribute_id": 108,
          "attribute_name": "内存",
          "attribute_value_id": 243,
          "attribute_value": "32G"
        },
        {
          "attribute_id": 208,
          "attribute_name": "上市年份",
          "attribute_value_id": 343,
          "attribute_value": "2019"
        }
      ],
      "stock": 190
    },
    {
      "sku_id": 102,
      "material_id": 70,
      "sku_price": 179,
      "main_img": 'SKU_1_PNG',
      "sku_prop": [
        {
          "attribute_id": 58,
          "attribute_name": "颜色",
          "attribute_value_id": 143,
          "attribute_value": "白色"
        },
        {
          "attribute_id": 108,
          "attribute_name": "内存",
          "attribute_value_id": 243,
          "attribute_value": "32G"
        },
        {
          "attribute_id": 208,
          "attribute_name": "上市年份",
          "attribute_value_id": 344,
          "attribute_value": "2020"
        }
      ],
      "stock": 190
    },
    {
      "sku_id": 103,
      "material_id": 70,
      "sku_price": 179,
      "main_img": 'SKU_1_PNG',
      "sku_prop": [
        {
          "attribute_id": 58,
          "attribute_name": "颜色",
          "attribute_value_id": 143,
          "attribute_value": "白色"
        },
        {
          "attribute_id": 108,
          "attribute_name": "内存",
          "attribute_value_id": 244,
          "attribute_value": "64G"
        },
        {
          "attribute_id": 208,
          "attribute_name": "上市年份",
          "attribute_value_id": 343,
          "attribute_value": "2019"
        }
      ],
      "stock": 190
    },
    {
      "sku_id": 106,
      "material_id": 70,
      "sku_price": 183,
      "main_img": 'SKU_2_PNG',
      "sku_prop": [
        {
          "attribute_id": 58,
          "attribute_name": "颜色",
          "attribute_value_id": 144,
          "attribute_value": "红色"
        },
        {
          "attribute_id": 108,
          "attribute_name": "内存",
          "attribute_value_id": 243,
          "attribute_value": "32G"
        },
        {
          "attribute_id": 208,
          "attribute_name": "上市年份",
          "attribute_value_id": 343,
          "attribute_value": "2019"
        }
      ],
      "stock": 223
    },
    {
      "sku_id": 109,
      "material_id": 70,
      "sku_price": 183,
      "main_img": 'SKU_2_PNG',
      "sku_prop": [
        {
          "attribute_id": 58,
          "attribute_name": "颜色",
          "attribute_value_id": 144,
          "attribute_value": "红色"
        },
        {
          "attribute_id": 108,
          "attribute_name": "内存",
          "attribute_value_id": 244,
          "attribute_value": "64G"
        },
        {
          "attribute_id": 208,
          "attribute_name": "上市年份",
          "attribute_value_id": 344,
          "attribute_value": "2020"
        }
      ],
      "stock": 223
    },
    {
      "sku_id": 107,
      "material_id": 70,
      "sku_price": 200,
      "main_img": 'SKU_2_PNG',
      "sku_prop": [
        {
          "attribute_id": 58,
          "attribute_name": "颜色",
          "attribute_value_id": 145,
          "attribute_value": "蓝色"
        },
        {
          "attribute_id": 108,
          "attribute_name": "内存",
          "attribute_value_id": 243,
          "attribute_value": "32G"
        },
        {
          "attribute_id": 208,
          "attribute_name": "上市年份",
          "attribute_value_id": 343,
          "attribute_value": "2019"
        }
      ],
      "stock": 223
    },
    {
      "sku_id": 108,
      "material_id": 70,
      "sku_price": 200,
      "main_img": 'SKU_2_PNG',
      "sku_prop": [
        {
          "attribute_id": 58,
          "attribute_name": "颜色",
          "attribute_value_id": 145,
          "attribute_value": "蓝色"
        },
        {
          "attribute_id": 108,
          "attribute_name": "内存",
          "attribute_value_id": 244,
          "attribute_value": "64G"
        },
        {
          "attribute_id": 208,
          "attribute_name": "上市年份",
          "attribute_value_id": 343,
          "attribute_value": "2019"
        }
      ],
      "stock": 223
    },
    {
      "sku_id": 109,
      "material_id": 70,
      "sku_price": 200,
      "main_img": 'SKU_2_PNG',
      "sku_prop": [
        {
          "attribute_id": 58,
          "attribute_name": "颜色",
          "attribute_value_id": 145,
          "attribute_value": "蓝色"
        },
        {
          "attribute_id": 108,
          "attribute_name": "内存",
          "attribute_value_id": 244,
          "attribute_value": "64G"
        },
        {
          "attribute_id": 208,
          "attribute_name": "上市年份",
          "attribute_value_id": 344,
          "attribute_value": "2020"
        }
      ],
      "stock": 223
    }
  ]
}

// 在 computed 中对数据进行输出，并得到三分数据：
// attrGroupList
// existSkuIdKey
// attrSameKey

function skuListMap() {
  const { sku_list } = dataSource;
  // 属性组数据
  const attributeGroupList = {};
  // 属性 sku_id 组
  const existSkuIdKey = {};
  // 同属性组
  const attrSameKey = {};

  (sku_list || []).forEach(list => {
    const { sku_prop } = list;
    // 获取属性组的 attribute_value_id，排序后用 | 分割
    const attrsIdKeys = (sku_prop || []).map(item => item.attribute_value_id).sort((a, b) => a - b).join("|");

    existSkuIdKey[attrsIdKeys] = list;

    (sku_prop || []).forEach(prop => {
      const valueInfo = {
        attribute_value_id: prop.attribute_value_id,
        attribute_value: prop.attribute_value
      };
      const hasAttrId = attributeGroupList[prop.attribute_id];
      // 属性组里不存在则新增
      if (hasAttrId === undefined) {
        attributeGroupList[prop.attribute_id] = {...prop, valueList: []};
        attrSameKey[prop.attribute_id] = [];
      }
      // 属性列表
      const existList = attributeGroupList[prop.attribute_id].valueList;
      // 判断 attribute_value_id 是否已存在属性组, 防止同一 attribute_value_id 多次添加
      const hasExistAttrId = existList.some(item => item.attribute_value_id === prop.attribute_value_id);
      if (!hasExistAttrId) {
        Array.prototype.push.call(attributeGroupList[prop.attribute_id].valueList, valueInfo);
        Array.prototype.push.call(attrSameKey[prop.attribute_id], prop.attribute_value_id);
      }
    });
  });

  const attrGroupList = Object.values(attributeGroupList);

  return {
    attrGroupList,
    existSkuIdKey,
    attrSameKey
  };
}

console.log(skuListMap())

</script>

</body>
</body>